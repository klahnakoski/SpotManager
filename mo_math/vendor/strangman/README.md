snagged from http://www.nmr.mgh.harvard.edu/Neural_Systems_Group/gary/python.html
